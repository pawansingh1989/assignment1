master code
complex modification started